<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>TicTacToe</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="style/stillinn.css">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js">
	</script>

 	<script type="text/javascript"> 
     	$(document).ready(function() {
    
   	   $('.unmarked').on('click' ,  function(e) {
        	e.preventDefault();
        	var pos = $(this).attr('id');
        	$(this).removeClass();
        	$.ajax({
          	type: "post",
          	url: "/game",
          	data: 'pos=' + pos,
          	success: function(data) {
            	player = data.charAt(0);
            	status = data.charAt(1);

         	   if(player === "1") {
              		$("#"+pos+":empty").append('<p class="marker">X</p>');

            	}
            else if(player === "2") {
              $("#"+pos+":empty").append('<p class="marker">O</p>');
            }

            if(status === "1") {
              $("#state-box").text('Player 1 wins');
              $("td:empty").append('<img src="circlecross.png" alt="Smiley face" height="100px" width="100px">');
            }
            else if(status === "2") {
              $("#state-box").text('Player 2 wins');
              $("td:empty").append('<img src="circlecross.png" alt="Smiley face" height="100px" width="100px">');
            }
            else if(status === "3") {
              $("#state-box").text('Nobody wins, fools');
              $("td:empty").append('<img src="circlecross.png" alt="Smiley face" height="100px" width="100px">');
            }
            else {
              $("#state-box").text('Playing...');
            }
          },
          error: function() {
            $('#state-box').text('Villa kom upp');
            $(this).attr('class', 'unmarked');
          }
        
      });
    });
    $(':button').on('click', function(e){
      e.preventDefault();
      $.get('/restart');
      $('.marker').remove();
      $('img').remove();
      $("#state-box").text(" ");
    });
  });
	</script>
		
		
</head>

<body>
<div id="Gameboard">
	<h1>TicTacToe</h1>
	<table>
		<tr>
			<td class="blank" id="a1"></td>
			<td class="blank" id="a2"></td>
			<td class="blank" id="a3"></td>
		</tr>
		<tr>
			<td class="blank" id="b1"></td>
			<td class="blank" id="b2"></td>
			<td class="blank" id="b3"></td>
		</tr>
		<tr>
			<td class="blank" id="c1"></td>
			<td class="blank" id="c2"></td>
			<td class="blank" id="c3"></td>
		</tr>
	</table>
	<button type = "button" id = "restart"> 
		Restart 
	</button>
	 
</div>
</body>
</html>

